# autogenerated by the Terraform Blueprint Metadata Generator
apiVersion: blueprints.cloud.google.com/v1alpha1
kind: TerraformBlueprint
metadata:
  name: terraform-google-iam-binding
  source:
    # A hypothetical source URL for this module.
    git:
      repoLink: https://github.com/GoogleCloudPlatform/terraform-google-iam-binding.git
spec:
  info:
    title: Google Cloud IAM Binding
    version: 1.0.0
    actuationTool:
      type: Terraform
      versions:
      - '>= 1.0'
    description:
      tagline: A flexible module for creating IAM bindings on various GCP resources.
      detailed: This module creates a single, authoritative IAM binding on a specified Google Cloud resource. It supports creating bindings on projects, GCS buckets, and service accounts. An optional IAM condition can also be applied to the binding.
    labels:
      - iam
      - security
  deployment:
    variables:
      - name: role
        description: The role that should be applied. For a list of roles, see https://cloud.google.com/iam/docs/understanding-roles.
        type: string
        required: true
      - name: members
        description: A list of users, service accounts, or groups who will be granted the specified role. For a list of supported member types, see https://cloud.google.com/iam/docs/overview#iam_members.
        type: list(string)
        required: true
      - name: project
        description: The ID of the project to which the role should be bound. Conflicts with `bucket` and `service_account_id`.
        type: string
        required: false
        default: null
      - name: bucket
        description: The name of the GCS bucket to which the role should be bound. Conflicts with `project` and `service_account_id`.
        type: string
        required: false
        default: null
      - name: service_account_id
        description: The fully-qualified ID of the service account to which the role should be bound. Conflicts with `project` and `bucket`. Example `projects/my-project/serviceAccounts/my-sa@my-project.iam.gserviceaccount.com`.
        type: string
        required: false
        default: null
      - name: condition
        description: An IAM condition block to apply to the binding. See https://cloud.google.com/iam/docs/conditions-overview for more information.
        type: object
        required: false
        default: null
    variableGroups:
      - displayName: Resource Identifier
        name: resource_identifier
        description: The identifier for the resource to which the IAM binding should be applied. Only one should be specified.
        variables:
        - project
        - bucket
        - service_account_id
    outputs:
      - name: id
        description: The fully-qualified ID of the created IAM binding. The format varies depending on the resource type. Returns null if no binding is created.
      - name: etag
        description: The etag of the created IAM binding. This is used for optimistic concurrency control. Returns null if no binding is created.
  requirements:
    # The services that must be enabled for this blueprint to be deployed.
    services:
      - cloudresourcemanager.googleapis.com
      - storage.googleapis.com
      - iam.googleapis.com
    # The IAM roles that the service account deploying this blueprint needs.
    roles:
      - level: Project
        role: roles/resourcemanager.projectIamAdmin
        reason: Required to set IAM policies on a project.
      - level: Project
        role: roles/storage.admin
        reason: Required to set IAM policies on a GCS bucket within the project.
      - level: Project
        role: roles/iam.serviceAccountAdmin
        reason: Required to set IAM policies on a service account within the project.
